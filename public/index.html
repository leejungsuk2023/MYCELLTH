<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="facebook-domain-verification" content="x0gmilmgkfk4uen7tr5z4jl4ijho0r" />
    <title>MYCELL Clinic - à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸à¸´à¹€à¸¨à¸©à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸™à¹„à¸—à¸¢à¹ƒà¸™à¹€à¸à¸²à¸«à¸¥à¸µ</title>

    <!-- Google Fonts - Prompt for Thai -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window, document,'script','https://connect.facebook.net/en_US/fbevents.js');

    fbq('init','742160555457168');
    fbq('track','PageView');
    console.log('ğŸ“± Facebook Pixel ì´ˆê¸°í™” ì™„ë£Œ - Pixel ID: 742160555457168');
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
           src="https://www.facebook.com/tr?id=742160555457168&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Facebook Pixel Code -->

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding-bottom: 80px; /* Space for sticky CTA */
        }

        /* ========== HERO SECTION ========== */
        .hero {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.5) 0%, rgba(118, 75, 162, 0.5) 100%),
                        url('/header-image.png') center/cover no-repeat;
            color: white;
            padding: 60px 20px;
            text-align: center;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .hero-badge {
            background: #ff4757;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: inline-block;
        }

        .hero h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 15px;
            line-height: 1.4;
            max-width: 600px;
        }

        .hero p {
            font-size: 1.1rem;
            opacity: 0.95;
            max-width: 500px;
            line-height: 1.8;
        }

        /* ========== PRICING SECTION ========== */
        .pricing-section {
            padding: 40px 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .pricing-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .pricing-card-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .price-item {
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .price-item:last-child {
            border-bottom: none;
        }

        .price-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }

        .price-values {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .price-original {
            color: #999;
            text-decoration: line-through;
            font-size: 0.9rem;
        }

        .price-sale {
            color: #ff4757;
            font-size: 1.3rem;
            font-weight: 700;
        }

        /* ========== TRUST SECTION ========== */
        .trust-section {
            padding: 40px 20px;
            background: white;
        }

        .trust-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 900px;
            margin: 0 auto;
        }

        .trust-item {
            text-align: center;
            padding: 20px;
        }

        .trust-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .trust-title {
            font-size: 1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .trust-desc {
            font-size: 0.85rem;
            color: #666;
        }

        /* ========== STICKY BOTTOM CTA ========== */
        .sticky-cta {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #00c851 0%, #007e33 100%);
            padding: 15px 20px;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
        }

        .cta-button {
            display: block;
            background: white;
            color: #00c851;
            text-align: center;
            padding: 15px 25px;
            border-radius: 30px;
            text-decoration: none;
            font-size: 1rem;
            font-weight: 700;
            max-width: 500px;
            margin: 0 auto;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .cta-button:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .cta-button:active {
            transform: scale(0.98);
        }

        .cta-free-gift {
            text-align: center;
            color: white;
            font-size: 0.8rem;
            margin-top: 8px;
            opacity: 0.9;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .hero {
                padding: 40px 15px;
                min-height: 350px;
            }

            .hero h1 {
                font-size: 1.5rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .pricing-grid {
                grid-template-columns: 1fr;
            }

            .trust-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .cta-button {
                font-size: 0.95rem;
                padding: 12px 20px;
            }
        }

        /* ========== LOADING MODAL ========== */
        .loading-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .loading-modal.show {
            display: flex;
        }

        .loading-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f0f0f0;
            border-top: 4px solid #00c851;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <!-- ========== HERO SECTION ========== -->
    <section class="hero">
        <span class="hero-badge">ğŸ‰ à¸à¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™ 2025</span>
        <h1>à¸„à¸™à¹„à¸—à¸¢à¹ƒà¸™à¹€à¸à¸²à¸«à¸¥à¸µà¸«à¹‰à¸²à¸¡à¸à¸¥à¸²à¸”! à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸à¸´à¹€à¸¨à¸© à¹€à¸”à¸·à¸­à¸™à¸à¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™</h1>
        <p>à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸ˆà¹ˆà¸²à¸¢à¹€à¸à¸´à¹ˆà¸¡à¹€à¸«à¸¡à¸·à¸­à¸™à¸™à¸±à¸à¸—à¹ˆà¸­à¸‡à¹€à¸—à¸µà¹ˆà¸¢à¸§ à¸£à¸²à¸„à¸²à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸šà¸„à¸™à¹€à¸à¸²à¸«à¸¥à¸µ 100%</p>
    </section>

    <!-- ========== PRICING SECTION ========== -->
    <section class="pricing-section">
        <h2 class="section-title">ğŸ’ à¸£à¸²à¸„à¸²à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸à¸´à¹€à¸¨à¸©</h2>

        <div class="pricing-grid">
            <!-- Lifting Card -->
            <div class="pricing-card">
                <h3 class="pricing-card-title">âœ¨ Lifting</h3>

                <div class="price-item">
                    <div class="price-name">Ulthera 300 shot</div>
                    <div class="price-values">
                        <span class="price-original">800,000â‚©</span>
                        <span class="price-sale">600,000â‚©</span>
                    </div>
                </div>

                <div class="price-item">
                    <div class="price-name">Ulthera 300 + Therma 300</div>
                    <div class="price-values">
                        <span class="price-original">1,200,000â‚©</span>
                        <span class="price-sale">890,000â‚©</span>
                    </div>
                </div>
            </div>

            <!-- Botox Card -->
            <div class="pricing-card">
                <h3 class="pricing-card-title">ğŸ’‰ Botox</h3>

                <div class="price-item">
                    <div class="price-name">Jaw 50 units</div>
                    <div class="price-values">
                        <span class="price-original">50,000â‚©</span>
                        <span class="price-sale">19,800â‚©</span>
                    </div>
                </div>

                <div class="price-item">
                    <div class="price-name">Body 100 units</div>
                    <div class="price-values">
                        <span class="price-original">150,000â‚©</span>
                        <span class="price-sale">75,000â‚©</span>
                    </div>
                </div>
            </div>

            <!-- Filler Card -->
            <div class="pricing-card">
                <h3 class="pricing-card-title">ğŸ’§ Filler</h3>

                <div class="price-item">
                    <div class="price-name">Forehead 3cc + Botox</div>
                    <div class="price-values">
                        <span class="price-original">200,000â‚©</span>
                        <span class="price-sale">99,000â‚©</span>
                    </div>
                </div>

                <div class="price-item">
                    <div class="price-name">Lip 1cc + Botox</div>
                    <div class="price-values">
                        <span class="price-original">150,000â‚©</span>
                        <span class="price-sale">79,000â‚©</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== TRUST SECTION ========== -->
    <section class="trust-section">
        <div class="trust-grid">
            <div class="trust-item">
                <div class="trust-icon">ğŸ’°</div>
                <div class="trust-title">à¸£à¸²à¸„à¸²à¸•à¸²à¸¡à¸›à¹‰à¸²à¸¢ à¹„à¸¡à¹ˆà¸šà¸§à¸à¹€à¸à¸´à¹ˆà¸¡à¸«à¸™à¹‰à¸²à¸‡à¸²à¸™</div>
                <div class="trust-desc">No Hidden Cost</div>
            </div>

            <div class="trust-item">
                <div class="trust-icon">ğŸ“¦</div>
                <div class="trust-title">à¹à¸à¸°à¸à¸¥à¹ˆà¸­à¸‡à¸¢à¸²/à¸«à¸±à¸§à¸—à¸´à¸›à¹ƒà¸«à¸¡à¹ˆ à¸•à¹ˆà¸­à¸«à¸™à¹‰à¸²à¸„à¸¸à¸“</div>
                <div class="trust-desc">Genuine Product</div>
            </div>

            <div class="trust-item">
                <div class="trust-icon">ğŸ‡¹ğŸ‡­</div>
                <div class="trust-title">à¸¡à¸µà¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸„à¸™à¹„à¸—à¸¢ à¸”à¸¹à¹à¸¥à¸•à¸¥à¸­à¸”à¸à¸²à¸£à¸£à¸±à¸à¸©à¸²</div>
                <div class="trust-desc">Thai Staff Available</div>
            </div>
        </div>
    </section>

    <!-- ========== STICKY BOTTOM CTA ========== -->
    <div class="sticky-cta">
        <a href="https://line.me/R/ti/p/@mycell-clinic" class="cta-button" id="lineButton">
            ğŸ‘‰ à¹à¸­à¸”à¹„à¸¥à¸™à¹Œà¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡ à¸£à¸±à¸šà¹‚à¸šà¸—à¹‡à¸­à¸à¸‹à¹Œà¸Ÿà¸£à¸µ!
        </a>
    </div>

    <!-- ========== LOADING MODAL ========== -->
    <div class="loading-modal" id="loadingModal">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>à¸à¸³à¸¥à¸±à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡ LINE...</p>
        </div>
    </div>

<script>
  // ====== ìœ í‹¸ ======
  const LINE_ID = '@mycell-clinic';

  // ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤ ê°ì§€
  function isMobile() {
    const userAgent = navigator.userAgent || navigator.vendor || window.opera;
    const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i;
    return mobileRegex.test(userAgent);
  }

  // ë””ë°”ì´ìŠ¤ë³„ LINE URL ë°˜í™˜
  function getLineURL() {
    const mobile = isMobile();
    let url;

    if (mobile) {
      url = `line://ti/p/${LINE_ID}`;
    } else {
      url = `https://line.me/R/ti/p/${LINE_ID}`;
    }

    console.log(`ğŸ“± ë””ë°”ì´ìŠ¤ íƒ€ì…: ${mobile ? 'ëª¨ë°”ì¼' : 'PC'}`);
    console.log(`ğŸ”— ì‚¬ìš©í•  LINE URL: ${url}`);

    return url;
  }

  const LINE_URL = getLineURL();

  function genEventId() {
    return 'cid-' + Date.now() + '-' + Math.random().toString(36).slice(2,10);
  }

  function getCookie(name) {
    const m = document.cookie.match(new RegExp('(?:^|; )' + name.replace(/([.$?*|{}()[]\\\/\+^])/g, '\\$1') + '=([^;]*)'));
    return m ? decodeURIComponent(m[1]) : '';
  }

  const COOKIE_MAX_AGE_DAYS = 180;

  function setCookie(name, value, days = COOKIE_MAX_AGE_DAYS) {
    const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
    document.cookie = `${name}=${value}; path=/; expires=${expires}; SameSite=Lax; Secure`;
  }

  function ensureFbpCookie() {
    if (!getCookie('_fbp')) {
      const newFbp = `fb.1.${Date.now()}.${Math.random().toString(36).slice(2,10)}`;
      setCookie('_fbp', newFbp);
      console.log('ğŸ§ _fbp ì¿ í‚¤ ìƒì„±:', newFbp);
    }
  }

  function ensureFbcFromQuery() {
    const params = new URLSearchParams(location.search);
    const fbclid = params.get('fbclid');
    if (fbclid) {
      const newFbc = `fb.1.${Date.now()}.${fbclid}`;
      setCookie('_fbc', newFbc, 90);
      console.log('ğŸ§ _fbc ì¿ í‚¤ ìƒì„± (fbclid ê¸°ë°˜):', newFbc);
    }
  }

  function getFbc() {
    return getCookie('_fbc') || '';
  }

  function checkPixelStatus() {
    console.log('ğŸ” í”½ì…€ ìƒíƒœ í™•ì¸:');
    console.log('  - fbq í•¨ìˆ˜ ì¡´ì¬:', typeof window.fbq === 'function');
    console.log('  - fbq ê°ì²´ ì¡´ì¬:', !!window.fbq);
    if (window.fbq) {
      console.log('  - fbq.queue ì¡´ì¬:', !!window.fbq.queue);
      console.log('  - fbq.loaded:', window.fbq.loaded);
      console.log('  - fbq.version:', window.fbq.version);
    }
  }

  // ì´ˆê¸° ì¿ í‚¤ ì„¸íŒ…
  ensureFbcFromQuery();
  ensureFbpCookie();

  // ====== ì„œë²„ CAPI ì „ì†¡ ======
  async function sendLeadToServer(eventId) {
    try {
      console.log('ğŸ“¨ sendLeadToServer() ì‹œì‘, eventId:', eventId);

      const payload = {
        eventId,
        eventSourceUrl: location.href,
        email: '',
        phone: '',
        fbp: getCookie('_fbp') || '',
        fbc: getFbc(),
        userAgent: navigator.userAgent
      };

      console.log('ğŸ“‹ ì „ì†¡í•  payload:', payload);
      console.log('ğŸŒ /api/lead ìš”ì²­ ì‹œì‘...');

      const response = await fetch('/api/lead', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload),
        keepalive: true
      });

      console.log('ğŸ“¡ ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status);
      const result = await response.json();
      console.log('ğŸ“„ ì„œë²„ ì‘ë‹µ ë‚´ìš©:', result);
      console.log('ğŸ” ìƒì„¸ Meta ì‘ë‹µ:', result.meta);

      if (response.ok) {
        console.log('âœ… CAPI ì „ì†¡ ì„±ê³µ!');
      } else {
        console.log('âŒ CAPI ì „ì†¡ ì‹¤íŒ¨:', result);
      }
    } catch(e) {
      console.error('ğŸš¨ CAPI ì „ì†¡ ì—ëŸ¬:', e);
    }
  }

  // ====== LineFriendAdd ì´ë²¤íŠ¸ ì „ì†¡ ======
  function trackLineFriendAdd() {
    console.log('ğŸš€ trackLineFriendAdd() í˜¸ì¶œë¨');
    const eventId = genEventId();
    console.log('ğŸ“‹ ìƒì„±ëœ eventId:', eventId);

    // ë¸Œë¼ìš°ì € í”½ì…€ ì „ì†¡
    if (typeof window.fbq === 'function') {
      console.log('âœ… fbq í•¨ìˆ˜ ì¡´ì¬ - ë¸Œë¼ìš°ì € í”½ì…€ ì „ì†¡');
      fbq('trackCustom', 'LineFriendAdd', {}, { eventID: eventId });
      console.log('ğŸ“Š Facebook Pixel LineFriendAdd ì´ë²¤íŠ¸ ì „ì†¡ ì™„ë£Œ');
    } else {
      console.log('âŒ fbq í•¨ìˆ˜ ì—†ìŒ');
      if (window.fbq && window.fbq.queue) {
        window.fbq.queue.push(['trackCustom', 'LineFriendAdd', {}, { eventID: eventId }]);
        console.log('ğŸ“‹ ì´ë²¤íŠ¸ íì— LineFriendAdd ì´ë²¤íŠ¸ ì¶”ê°€ë¨');
      }
    }

    // ì„œë²„ CAPI ì „ì†¡
    console.log('ğŸŒ ì„œë²„ CAPI ì „ì†¡ ì‹œì‘');
    sendLeadToServer(eventId);

    return eventId;
  }

  // ë¡œë”© ëª¨ë‹¬ í‘œì‹œ
  function showLoadingModal() {
    document.getElementById('loadingModal').classList.add('show');
  }

  function hideLoadingModal() {
    document.getElementById('loadingModal').classList.remove('show');
  }

  // DOM ë¡œë“œ ì™„ë£Œ í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
  function initEventListeners() {
    console.log('ğŸ”§ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™” ì‹œì‘');
    checkPixelStatus();

    // Sticky CTA ë²„íŠ¼
    const lineBtn = document.getElementById('lineButton');
    if (lineBtn) {
      // ë””ë°”ì´ìŠ¤ì— ë§ëŠ” LINE URLë¡œ ë™ì  ì—…ë°ì´íŠ¸
      lineBtn.href = LINE_URL;
      console.log('âœ… ë¼ì¸ ë²„íŠ¼ ì°¾ìŒ - href ì—…ë°ì´íŠ¸:', LINE_URL);

      lineBtn.addEventListener('click', function(event) {
        event.preventDefault();
        console.log('ğŸ¯ CTA ë²„íŠ¼ í´ë¦­ë¨');

        // ë¡œë”© ëª¨ë‹¬ í‘œì‹œ
        showLoadingModal();

        // LineFriendAdd ì´ë²¤íŠ¸ ì „ì†¡
        const eventId = trackLineFriendAdd();

        // CAPI ì „ì†¡ í›„ LINEìœ¼ë¡œ ì´ë™
        setTimeout(function() {
          hideLoadingModal();
          window.location.href = lineBtn.href;
        }, 1200);
      });
    } else {
      console.log('âŒ ë¼ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    }
  }

  // DOM ë¡œë“œ ì™„ë£Œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™”
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initEventListeners);
  } else {
    initEventListeners();
  }
</script>
</body>
</html>
